<?php
function destroySessionToken() {  # Destroy any session with the name 'session_token'
	unset($_SESSION['session_token']);
}

function generateSessionToken() {  # Generate a brand new (CSRF) token
	if(isset($_SESSION['session_token'])) {
		destroySessionToken();
	}
	$_SESSION['session_token'] = bin2hex(random_bytes(32));
}

function checkToken($user_token, $session_token){
    if (isset($user_token) && isset($session_token)){
        if ($user_token != $session_token){
            header("Location: lobby.php");
        } 
    } 
} 